import{e as y,u as C,r as a,i as N,j as e,L as f,T as p,B as T}from"./index-BnfdKZVy.js";import{P as S,C as k}from"./PageTitle-Dkg9so6R.js";import{E as c}from"./ErrorBanner-94absO_y.js";import{P as E}from"./PasswordStrength-MeHRcjj9.js";function q(){const{token:t}=y({from:"/reset-password"}),j=C(),[s,v]=a.useState(""),[n,h]=a.useState(""),[u,d]=a.useState(!1),[m,g]=a.useState(!1),o=a.useMemo(()=>u?s.length>=6?"":"Mínimo 6 caracteres":"",[s,u]),i=a.useMemo(()=>m?s===n?"":"Las contraseñas no coinciden":"",[s,n,m]),{mutateAsync:w,isPending:b,error:l,isSuccess:x}=N(),P=async r=>{r.preventDefault(),d(!0),g(!0),!(!t||o||i)&&await w({token:t,password:s})};return e.jsxs("div",{className:"mx-auto grid w-full max-w-md grid-cols-1 gap-6 px-2 sm:max-w-lg",children:[e.jsx(S,{children:"Definir nueva contraseña"}),e.jsx(k,{padding:"lg",children:t?e.jsxs("form",{className:"space-y-5",onSubmit:P,noValidate:!0,children:[e.jsx(p,{label:"Nueva contraseña",type:"password",required:!0,value:s,onBlur:()=>d(!0),onChange:r=>v(r.currentTarget.value),revealToggle:!0,error:o}),e.jsx(E,{value:s}),e.jsx(p,{label:"Confirmar contraseña",type:"password",required:!0,value:n,onBlur:()=>g(!0),onChange:r=>h(r.currentTarget.value),revealToggle:!0,error:i}),e.jsx(c,{msg:l==null?void 0:l.message}),x&&e.jsx(c,{variant:"success",title:"Actualizada",msg:"¡Listo! Ya podés ingresar con tu nueva contraseña."}),e.jsxs("div",{className:"flex flex-col-reverse gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx(f,{to:"/login",className:"link text-sm",children:"Ir a Ingresar"}),e.jsx(T,{type:"submit",loading:b,loadingText:"Guardando…",disabled:!!o||!!i,children:"Guardar contraseña"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{msg:"Falta el token en la URL (?token=…)"}),e.jsx(f,{to:"/forgot-password",className:"btn btn-ghost",children:"Volver a recuperar"})]})}),x&&e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>j({to:"/login"}),className:"btn btn-primary",children:"Continuar a Login"})})]})}export{q as default};
